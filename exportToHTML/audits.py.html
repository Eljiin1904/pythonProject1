<html>
<head>
<title>audits.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #808080;}
.s1 { color: #a9b7c6;}
.s2 { color: #cc7832;}
.s3 { color: #629755; font-style: italic;}
.s4 { color: #6a8759;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
audits.py</font>
</center></td></tr></table>
<pre><span class="s0"># DO NOT EDIT THIS FILE!</span>
<span class="s0">#</span>
<span class="s0"># This file is generated from the CDP specification. If you need to make</span>
<span class="s0"># changes, edit the generator and regenerate all of the modules.</span>
<span class="s0">#</span>
<span class="s0"># CDP domain: Audits (experimental)</span>
<span class="s2">from </span><span class="s1">__future__ </span><span class="s2">import </span><span class="s1">annotations</span>
<span class="s2">from </span><span class="s1">.util </span><span class="s2">import </span><span class="s1">event_class</span><span class="s2">, </span><span class="s1">T_JSON_DICT</span>
<span class="s2">from </span><span class="s1">dataclasses </span><span class="s2">import </span><span class="s1">dataclass</span>
<span class="s2">import </span><span class="s1">enum</span>
<span class="s2">import </span><span class="s1">typing</span>
<span class="s2">from </span><span class="s1">. </span><span class="s2">import </span><span class="s1">dom</span>
<span class="s2">from </span><span class="s1">. </span><span class="s2">import </span><span class="s1">network</span>
<span class="s2">from </span><span class="s1">. </span><span class="s2">import </span><span class="s1">page</span>
<span class="s2">from </span><span class="s1">. </span><span class="s2">import </span><span class="s1">runtime</span>


<span class="s1">@dataclass</span>
<span class="s2">class </span><span class="s1">AffectedCookie:</span>
    <span class="s3">''' 
    Information about a cookie that is affected by an inspector issue. 
    '''</span>
    <span class="s0">#: The following three properties uniquely identify a cookie</span>
    <span class="s1">name: str</span>

    <span class="s1">path: str</span>

    <span class="s1">domain: str</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s1">json = dict()</span>
        <span class="s1">json[</span><span class="s4">'name'</span><span class="s1">] = self.name</span>
        <span class="s1">json[</span><span class="s4">'path'</span><span class="s1">] = self.path</span>
        <span class="s1">json[</span><span class="s4">'domain'</span><span class="s1">] = self.domain</span>
        <span class="s2">return </span><span class="s1">json</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(</span>
            <span class="s1">name=str(json[</span><span class="s4">'name'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">path=str(json[</span><span class="s4">'path'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">domain=str(json[</span><span class="s4">'domain'</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>


<span class="s1">@dataclass</span>
<span class="s2">class </span><span class="s1">AffectedRequest:</span>
    <span class="s3">''' 
    Information about a request that is affected by an inspector issue. 
    '''</span>
    <span class="s0">#: The unique request id.</span>
    <span class="s1">request_id: network.RequestId</span>

    <span class="s1">url: typing.Optional[str] = </span><span class="s2">None</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s1">json = dict()</span>
        <span class="s1">json[</span><span class="s4">'requestId'</span><span class="s1">] = self.request_id.to_json()</span>
        <span class="s2">if </span><span class="s1">self.url </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'url'</span><span class="s1">] = self.url</span>
        <span class="s2">return </span><span class="s1">json</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(</span>
            <span class="s1">request_id=network.RequestId.from_json(json[</span><span class="s4">'requestId'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">url=str(json[</span><span class="s4">'url'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'url' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
        <span class="s1">)</span>


<span class="s1">@dataclass</span>
<span class="s2">class </span><span class="s1">AffectedFrame:</span>
    <span class="s3">''' 
    Information about the frame affected by an inspector issue. 
    '''</span>
    <span class="s1">frame_id: page.FrameId</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s1">json = dict()</span>
        <span class="s1">json[</span><span class="s4">'frameId'</span><span class="s1">] = self.frame_id.to_json()</span>
        <span class="s2">return </span><span class="s1">json</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(</span>
            <span class="s1">frame_id=page.FrameId.from_json(json[</span><span class="s4">'frameId'</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>


<span class="s2">class </span><span class="s1">SameSiteCookieExclusionReason(enum.Enum):</span>
    <span class="s1">EXCLUDE_SAME_SITE_UNSPECIFIED_TREATED_AS_LAX = </span><span class="s4">&quot;ExcludeSameSiteUnspecifiedTreatedAsLax&quot;</span>
    <span class="s1">EXCLUDE_SAME_SITE_NONE_INSECURE = </span><span class="s4">&quot;ExcludeSameSiteNoneInsecure&quot;</span>
    <span class="s1">EXCLUDE_SAME_SITE_LAX = </span><span class="s4">&quot;ExcludeSameSiteLax&quot;</span>
    <span class="s1">EXCLUDE_SAME_SITE_STRICT = </span><span class="s4">&quot;ExcludeSameSiteStrict&quot;</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s2">return </span><span class="s1">self.value</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(json)</span>


<span class="s2">class </span><span class="s1">SameSiteCookieWarningReason(enum.Enum):</span>
    <span class="s1">WARN_SAME_SITE_UNSPECIFIED_CROSS_SITE_CONTEXT = </span><span class="s4">&quot;WarnSameSiteUnspecifiedCrossSiteContext&quot;</span>
    <span class="s1">WARN_SAME_SITE_NONE_INSECURE = </span><span class="s4">&quot;WarnSameSiteNoneInsecure&quot;</span>
    <span class="s1">WARN_SAME_SITE_UNSPECIFIED_LAX_ALLOW_UNSAFE = </span><span class="s4">&quot;WarnSameSiteUnspecifiedLaxAllowUnsafe&quot;</span>
    <span class="s1">WARN_SAME_SITE_STRICT_LAX_DOWNGRADE_STRICT = </span><span class="s4">&quot;WarnSameSiteStrictLaxDowngradeStrict&quot;</span>
    <span class="s1">WARN_SAME_SITE_STRICT_CROSS_DOWNGRADE_STRICT = </span><span class="s4">&quot;WarnSameSiteStrictCrossDowngradeStrict&quot;</span>
    <span class="s1">WARN_SAME_SITE_STRICT_CROSS_DOWNGRADE_LAX = </span><span class="s4">&quot;WarnSameSiteStrictCrossDowngradeLax&quot;</span>
    <span class="s1">WARN_SAME_SITE_LAX_CROSS_DOWNGRADE_STRICT = </span><span class="s4">&quot;WarnSameSiteLaxCrossDowngradeStrict&quot;</span>
    <span class="s1">WARN_SAME_SITE_LAX_CROSS_DOWNGRADE_LAX = </span><span class="s4">&quot;WarnSameSiteLaxCrossDowngradeLax&quot;</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s2">return </span><span class="s1">self.value</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(json)</span>


<span class="s2">class </span><span class="s1">SameSiteCookieOperation(enum.Enum):</span>
    <span class="s1">SET_COOKIE = </span><span class="s4">&quot;SetCookie&quot;</span>
    <span class="s1">READ_COOKIE = </span><span class="s4">&quot;ReadCookie&quot;</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s2">return </span><span class="s1">self.value</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(json)</span>


<span class="s1">@dataclass</span>
<span class="s2">class </span><span class="s1">SameSiteCookieIssueDetails:</span>
    <span class="s3">''' 
    This information is currently necessary, as the front-end has a difficult 
    time finding a specific cookie. With this, we can convey specific error 
    information without the cookie. 
    '''</span>
    <span class="s1">cookie: AffectedCookie</span>

    <span class="s1">cookie_warning_reasons: typing.List[SameSiteCookieWarningReason]</span>

    <span class="s1">cookie_exclusion_reasons: typing.List[SameSiteCookieExclusionReason]</span>

    <span class="s0">#: Optionally identifies the site-for-cookies and the cookie url, which</span>
    <span class="s0">#: may be used by the front-end as additional context.</span>
    <span class="s1">operation: SameSiteCookieOperation</span>

    <span class="s1">site_for_cookies: typing.Optional[str] = </span><span class="s2">None</span>

    <span class="s1">cookie_url: typing.Optional[str] = </span><span class="s2">None</span>

    <span class="s1">request: typing.Optional[AffectedRequest] = </span><span class="s2">None</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s1">json = dict()</span>
        <span class="s1">json[</span><span class="s4">'cookie'</span><span class="s1">] = self.cookie.to_json()</span>
        <span class="s1">json[</span><span class="s4">'cookieWarningReasons'</span><span class="s1">] = [i.to_json() </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">self.cookie_warning_reasons]</span>
        <span class="s1">json[</span><span class="s4">'cookieExclusionReasons'</span><span class="s1">] = [i.to_json() </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">self.cookie_exclusion_reasons]</span>
        <span class="s1">json[</span><span class="s4">'operation'</span><span class="s1">] = self.operation.to_json()</span>
        <span class="s2">if </span><span class="s1">self.site_for_cookies </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'siteForCookies'</span><span class="s1">] = self.site_for_cookies</span>
        <span class="s2">if </span><span class="s1">self.cookie_url </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'cookieUrl'</span><span class="s1">] = self.cookie_url</span>
        <span class="s2">if </span><span class="s1">self.request </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'request'</span><span class="s1">] = self.request.to_json()</span>
        <span class="s2">return </span><span class="s1">json</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(</span>
            <span class="s1">cookie=AffectedCookie.from_json(json[</span><span class="s4">'cookie'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">cookie_warning_reasons=[SameSiteCookieWarningReason.from_json(i) </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">json[</span><span class="s4">'cookieWarningReasons'</span><span class="s1">]]</span><span class="s2">,</span>
            <span class="s1">cookie_exclusion_reasons=[SameSiteCookieExclusionReason.from_json(i) </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">json[</span><span class="s4">'cookieExclusionReasons'</span><span class="s1">]]</span><span class="s2">,</span>
            <span class="s1">operation=SameSiteCookieOperation.from_json(json[</span><span class="s4">'operation'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">site_for_cookies=str(json[</span><span class="s4">'siteForCookies'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'siteForCookies' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
            <span class="s1">cookie_url=str(json[</span><span class="s4">'cookieUrl'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'cookieUrl' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
            <span class="s1">request=AffectedRequest.from_json(json[</span><span class="s4">'request'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'request' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
        <span class="s1">)</span>


<span class="s2">class </span><span class="s1">MixedContentResolutionStatus(enum.Enum):</span>
    <span class="s1">MIXED_CONTENT_BLOCKED = </span><span class="s4">&quot;MixedContentBlocked&quot;</span>
    <span class="s1">MIXED_CONTENT_AUTOMATICALLY_UPGRADED = </span><span class="s4">&quot;MixedContentAutomaticallyUpgraded&quot;</span>
    <span class="s1">MIXED_CONTENT_WARNING = </span><span class="s4">&quot;MixedContentWarning&quot;</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s2">return </span><span class="s1">self.value</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(json)</span>


<span class="s2">class </span><span class="s1">MixedContentResourceType(enum.Enum):</span>
    <span class="s1">AUDIO = </span><span class="s4">&quot;Audio&quot;</span>
    <span class="s1">BEACON = </span><span class="s4">&quot;Beacon&quot;</span>
    <span class="s1">CSP_REPORT = </span><span class="s4">&quot;CSPReport&quot;</span>
    <span class="s1">DOWNLOAD = </span><span class="s4">&quot;Download&quot;</span>
    <span class="s1">EVENT_SOURCE = </span><span class="s4">&quot;EventSource&quot;</span>
    <span class="s1">FAVICON = </span><span class="s4">&quot;Favicon&quot;</span>
    <span class="s1">FONT = </span><span class="s4">&quot;Font&quot;</span>
    <span class="s1">FORM = </span><span class="s4">&quot;Form&quot;</span>
    <span class="s1">FRAME = </span><span class="s4">&quot;Frame&quot;</span>
    <span class="s1">IMAGE = </span><span class="s4">&quot;Image&quot;</span>
    <span class="s1">IMPORT = </span><span class="s4">&quot;Import&quot;</span>
    <span class="s1">MANIFEST = </span><span class="s4">&quot;Manifest&quot;</span>
    <span class="s1">PING = </span><span class="s4">&quot;Ping&quot;</span>
    <span class="s1">PLUGIN_DATA = </span><span class="s4">&quot;PluginData&quot;</span>
    <span class="s1">PLUGIN_RESOURCE = </span><span class="s4">&quot;PluginResource&quot;</span>
    <span class="s1">PREFETCH = </span><span class="s4">&quot;Prefetch&quot;</span>
    <span class="s1">RESOURCE = </span><span class="s4">&quot;Resource&quot;</span>
    <span class="s1">SCRIPT = </span><span class="s4">&quot;Script&quot;</span>
    <span class="s1">SERVICE_WORKER = </span><span class="s4">&quot;ServiceWorker&quot;</span>
    <span class="s1">SHARED_WORKER = </span><span class="s4">&quot;SharedWorker&quot;</span>
    <span class="s1">STYLESHEET = </span><span class="s4">&quot;Stylesheet&quot;</span>
    <span class="s1">TRACK = </span><span class="s4">&quot;Track&quot;</span>
    <span class="s1">VIDEO = </span><span class="s4">&quot;Video&quot;</span>
    <span class="s1">WORKER = </span><span class="s4">&quot;Worker&quot;</span>
    <span class="s1">XML_HTTP_REQUEST = </span><span class="s4">&quot;XMLHttpRequest&quot;</span>
    <span class="s1">XSLT = </span><span class="s4">&quot;XSLT&quot;</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s2">return </span><span class="s1">self.value</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(json)</span>


<span class="s1">@dataclass</span>
<span class="s2">class </span><span class="s1">MixedContentIssueDetails:</span>
    <span class="s0">#: The way the mixed content issue is being resolved.</span>
    <span class="s1">resolution_status: MixedContentResolutionStatus</span>

    <span class="s0">#: The unsafe http url causing the mixed content issue.</span>
    <span class="s1">insecure_url: str</span>

    <span class="s0">#: The url responsible for the call to an unsafe url.</span>
    <span class="s1">main_resource_url: str</span>

    <span class="s0">#: The type of resource causing the mixed content issue (css, js, iframe,</span>
    <span class="s0">#: form,...). Marked as optional because it is mapped to from</span>
    <span class="s0">#: blink::mojom::RequestContextType, which will be replaced</span>
    <span class="s0">#: by network::mojom::RequestDestination</span>
    <span class="s1">resource_type: typing.Optional[MixedContentResourceType] = </span><span class="s2">None</span>

    <span class="s0">#: The mixed content request.</span>
    <span class="s0">#: Does not always exist (e.g. for unsafe form submission urls).</span>
    <span class="s1">request: typing.Optional[AffectedRequest] = </span><span class="s2">None</span>

    <span class="s0">#: Optional because not every mixed content issue is necessarily linked to a frame.</span>
    <span class="s1">frame: typing.Optional[AffectedFrame] = </span><span class="s2">None</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s1">json = dict()</span>
        <span class="s1">json[</span><span class="s4">'resolutionStatus'</span><span class="s1">] = self.resolution_status.to_json()</span>
        <span class="s1">json[</span><span class="s4">'insecureURL'</span><span class="s1">] = self.insecure_url</span>
        <span class="s1">json[</span><span class="s4">'mainResourceURL'</span><span class="s1">] = self.main_resource_url</span>
        <span class="s2">if </span><span class="s1">self.resource_type </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'resourceType'</span><span class="s1">] = self.resource_type.to_json()</span>
        <span class="s2">if </span><span class="s1">self.request </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'request'</span><span class="s1">] = self.request.to_json()</span>
        <span class="s2">if </span><span class="s1">self.frame </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'frame'</span><span class="s1">] = self.frame.to_json()</span>
        <span class="s2">return </span><span class="s1">json</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(</span>
            <span class="s1">resolution_status=MixedContentResolutionStatus.from_json(json[</span><span class="s4">'resolutionStatus'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">insecure_url=str(json[</span><span class="s4">'insecureURL'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">main_resource_url=str(json[</span><span class="s4">'mainResourceURL'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">resource_type=MixedContentResourceType.from_json(json[</span><span class="s4">'resourceType'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'resourceType' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
            <span class="s1">request=AffectedRequest.from_json(json[</span><span class="s4">'request'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'request' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
            <span class="s1">frame=AffectedFrame.from_json(json[</span><span class="s4">'frame'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'frame' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
        <span class="s1">)</span>


<span class="s2">class </span><span class="s1">BlockedByResponseReason(enum.Enum):</span>
    <span class="s3">''' 
    Enum indicating the reason a response has been blocked. These reasons are 
    refinements of the net error BLOCKED_BY_RESPONSE. 
    '''</span>
    <span class="s1">COEP_FRAME_RESOURCE_NEEDS_COEP_HEADER = </span><span class="s4">&quot;CoepFrameResourceNeedsCoepHeader&quot;</span>
    <span class="s1">COOP_SANDBOXED_I_FRAME_CANNOT_NAVIGATE_TO_COOP_PAGE = </span><span class="s4">&quot;CoopSandboxedIFrameCannotNavigateToCoopPage&quot;</span>
    <span class="s1">CORP_NOT_SAME_ORIGIN = </span><span class="s4">&quot;CorpNotSameOrigin&quot;</span>
    <span class="s1">CORP_NOT_SAME_ORIGIN_AFTER_DEFAULTED_TO_SAME_ORIGIN_BY_COEP = </span><span class="s4">&quot;CorpNotSameOriginAfterDefaultedToSameOriginByCoep&quot;</span>
    <span class="s1">CORP_NOT_SAME_SITE = </span><span class="s4">&quot;CorpNotSameSite&quot;</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s2">return </span><span class="s1">self.value</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(json)</span>


<span class="s1">@dataclass</span>
<span class="s2">class </span><span class="s1">BlockedByResponseIssueDetails:</span>
    <span class="s3">''' 
    Details for a request that has been blocked with the BLOCKED_BY_RESPONSE 
    code. Currently only used for COEP/COOP, but may be extended to include 
    some CSP errors in the future. 
    '''</span>
    <span class="s1">request: AffectedRequest</span>

    <span class="s1">reason: BlockedByResponseReason</span>

    <span class="s1">parent_frame: typing.Optional[AffectedFrame] = </span><span class="s2">None</span>

    <span class="s1">blocked_frame: typing.Optional[AffectedFrame] = </span><span class="s2">None</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s1">json = dict()</span>
        <span class="s1">json[</span><span class="s4">'request'</span><span class="s1">] = self.request.to_json()</span>
        <span class="s1">json[</span><span class="s4">'reason'</span><span class="s1">] = self.reason.to_json()</span>
        <span class="s2">if </span><span class="s1">self.parent_frame </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'parentFrame'</span><span class="s1">] = self.parent_frame.to_json()</span>
        <span class="s2">if </span><span class="s1">self.blocked_frame </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'blockedFrame'</span><span class="s1">] = self.blocked_frame.to_json()</span>
        <span class="s2">return </span><span class="s1">json</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(</span>
            <span class="s1">request=AffectedRequest.from_json(json[</span><span class="s4">'request'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">reason=BlockedByResponseReason.from_json(json[</span><span class="s4">'reason'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">parent_frame=AffectedFrame.from_json(json[</span><span class="s4">'parentFrame'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'parentFrame' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
            <span class="s1">blocked_frame=AffectedFrame.from_json(json[</span><span class="s4">'blockedFrame'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'blockedFrame' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
        <span class="s1">)</span>


<span class="s2">class </span><span class="s1">HeavyAdResolutionStatus(enum.Enum):</span>
    <span class="s1">HEAVY_AD_BLOCKED = </span><span class="s4">&quot;HeavyAdBlocked&quot;</span>
    <span class="s1">HEAVY_AD_WARNING = </span><span class="s4">&quot;HeavyAdWarning&quot;</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s2">return </span><span class="s1">self.value</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(json)</span>


<span class="s2">class </span><span class="s1">HeavyAdReason(enum.Enum):</span>
    <span class="s1">NETWORK_TOTAL_LIMIT = </span><span class="s4">&quot;NetworkTotalLimit&quot;</span>
    <span class="s1">CPU_TOTAL_LIMIT = </span><span class="s4">&quot;CpuTotalLimit&quot;</span>
    <span class="s1">CPU_PEAK_LIMIT = </span><span class="s4">&quot;CpuPeakLimit&quot;</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s2">return </span><span class="s1">self.value</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(json)</span>


<span class="s1">@dataclass</span>
<span class="s2">class </span><span class="s1">HeavyAdIssueDetails:</span>
    <span class="s0">#: The resolution status, either blocking the content or warning.</span>
    <span class="s1">resolution: HeavyAdResolutionStatus</span>

    <span class="s0">#: The reason the ad was blocked, total network or cpu or peak cpu.</span>
    <span class="s1">reason: HeavyAdReason</span>

    <span class="s0">#: The frame that was blocked.</span>
    <span class="s1">frame: AffectedFrame</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s1">json = dict()</span>
        <span class="s1">json[</span><span class="s4">'resolution'</span><span class="s1">] = self.resolution.to_json()</span>
        <span class="s1">json[</span><span class="s4">'reason'</span><span class="s1">] = self.reason.to_json()</span>
        <span class="s1">json[</span><span class="s4">'frame'</span><span class="s1">] = self.frame.to_json()</span>
        <span class="s2">return </span><span class="s1">json</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(</span>
            <span class="s1">resolution=HeavyAdResolutionStatus.from_json(json[</span><span class="s4">'resolution'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">reason=HeavyAdReason.from_json(json[</span><span class="s4">'reason'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">frame=AffectedFrame.from_json(json[</span><span class="s4">'frame'</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>


<span class="s2">class </span><span class="s1">ContentSecurityPolicyViolationType(enum.Enum):</span>
    <span class="s1">K_INLINE_VIOLATION = </span><span class="s4">&quot;kInlineViolation&quot;</span>
    <span class="s1">K_EVAL_VIOLATION = </span><span class="s4">&quot;kEvalViolation&quot;</span>
    <span class="s1">K_URL_VIOLATION = </span><span class="s4">&quot;kURLViolation&quot;</span>
    <span class="s1">K_TRUSTED_TYPES_SINK_VIOLATION = </span><span class="s4">&quot;kTrustedTypesSinkViolation&quot;</span>
    <span class="s1">K_TRUSTED_TYPES_POLICY_VIOLATION = </span><span class="s4">&quot;kTrustedTypesPolicyViolation&quot;</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s2">return </span><span class="s1">self.value</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(json)</span>


<span class="s1">@dataclass</span>
<span class="s2">class </span><span class="s1">SourceCodeLocation:</span>
    <span class="s1">url: str</span>

    <span class="s1">line_number: int</span>

    <span class="s1">column_number: int</span>

    <span class="s1">script_id: typing.Optional[runtime.ScriptId] = </span><span class="s2">None</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s1">json = dict()</span>
        <span class="s1">json[</span><span class="s4">'url'</span><span class="s1">] = self.url</span>
        <span class="s1">json[</span><span class="s4">'lineNumber'</span><span class="s1">] = self.line_number</span>
        <span class="s1">json[</span><span class="s4">'columnNumber'</span><span class="s1">] = self.column_number</span>
        <span class="s2">if </span><span class="s1">self.script_id </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'scriptId'</span><span class="s1">] = self.script_id.to_json()</span>
        <span class="s2">return </span><span class="s1">json</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(</span>
            <span class="s1">url=str(json[</span><span class="s4">'url'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">line_number=int(json[</span><span class="s4">'lineNumber'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">column_number=int(json[</span><span class="s4">'columnNumber'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">script_id=runtime.ScriptId.from_json(json[</span><span class="s4">'scriptId'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'scriptId' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
        <span class="s1">)</span>


<span class="s1">@dataclass</span>
<span class="s2">class </span><span class="s1">ContentSecurityPolicyIssueDetails:</span>
    <span class="s0">#: Specific directive that is violated, causing the CSP issue.</span>
    <span class="s1">violated_directive: str</span>

    <span class="s1">is_report_only: bool</span>

    <span class="s1">content_security_policy_violation_type: ContentSecurityPolicyViolationType</span>

    <span class="s0">#: The url not included in allowed sources.</span>
    <span class="s1">blocked_url: typing.Optional[str] = </span><span class="s2">None</span>

    <span class="s1">frame_ancestor: typing.Optional[AffectedFrame] = </span><span class="s2">None</span>

    <span class="s1">source_code_location: typing.Optional[SourceCodeLocation] = </span><span class="s2">None</span>

    <span class="s1">violating_node_id: typing.Optional[dom.BackendNodeId] = </span><span class="s2">None</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s1">json = dict()</span>
        <span class="s1">json[</span><span class="s4">'violatedDirective'</span><span class="s1">] = self.violated_directive</span>
        <span class="s1">json[</span><span class="s4">'isReportOnly'</span><span class="s1">] = self.is_report_only</span>
        <span class="s1">json[</span><span class="s4">'contentSecurityPolicyViolationType'</span><span class="s1">] = self.content_security_policy_violation_type.to_json()</span>
        <span class="s2">if </span><span class="s1">self.blocked_url </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'blockedURL'</span><span class="s1">] = self.blocked_url</span>
        <span class="s2">if </span><span class="s1">self.frame_ancestor </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'frameAncestor'</span><span class="s1">] = self.frame_ancestor.to_json()</span>
        <span class="s2">if </span><span class="s1">self.source_code_location </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'sourceCodeLocation'</span><span class="s1">] = self.source_code_location.to_json()</span>
        <span class="s2">if </span><span class="s1">self.violating_node_id </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'violatingNodeId'</span><span class="s1">] = self.violating_node_id.to_json()</span>
        <span class="s2">return </span><span class="s1">json</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(</span>
            <span class="s1">violated_directive=str(json[</span><span class="s4">'violatedDirective'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">is_report_only=bool(json[</span><span class="s4">'isReportOnly'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">content_security_policy_violation_type=ContentSecurityPolicyViolationType.from_json(json[</span><span class="s4">'contentSecurityPolicyViolationType'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">blocked_url=str(json[</span><span class="s4">'blockedURL'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'blockedURL' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
            <span class="s1">frame_ancestor=AffectedFrame.from_json(json[</span><span class="s4">'frameAncestor'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'frameAncestor' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
            <span class="s1">source_code_location=SourceCodeLocation.from_json(json[</span><span class="s4">'sourceCodeLocation'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'sourceCodeLocation' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
            <span class="s1">violating_node_id=dom.BackendNodeId.from_json(json[</span><span class="s4">'violatingNodeId'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'violatingNodeId' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
        <span class="s1">)</span>


<span class="s2">class </span><span class="s1">SharedArrayBufferIssueType(enum.Enum):</span>
    <span class="s1">TRANSFER_ISSUE = </span><span class="s4">&quot;TransferIssue&quot;</span>
    <span class="s1">CREATION_ISSUE = </span><span class="s4">&quot;CreationIssue&quot;</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s2">return </span><span class="s1">self.value</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(json)</span>


<span class="s1">@dataclass</span>
<span class="s2">class </span><span class="s1">SharedArrayBufferIssueDetails:</span>
    <span class="s3">''' 
    Details for a issue arising from an SAB being instantiated in, or 
    transfered to a context that is not cross-origin isolated. 
    '''</span>
    <span class="s1">source_code_location: SourceCodeLocation</span>

    <span class="s1">is_warning: bool</span>

    <span class="s1">type_: SharedArrayBufferIssueType</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s1">json = dict()</span>
        <span class="s1">json[</span><span class="s4">'sourceCodeLocation'</span><span class="s1">] = self.source_code_location.to_json()</span>
        <span class="s1">json[</span><span class="s4">'isWarning'</span><span class="s1">] = self.is_warning</span>
        <span class="s1">json[</span><span class="s4">'type'</span><span class="s1">] = self.type_.to_json()</span>
        <span class="s2">return </span><span class="s1">json</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(</span>
            <span class="s1">source_code_location=SourceCodeLocation.from_json(json[</span><span class="s4">'sourceCodeLocation'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">is_warning=bool(json[</span><span class="s4">'isWarning'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">type_=SharedArrayBufferIssueType.from_json(json[</span><span class="s4">'type'</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>


<span class="s2">class </span><span class="s1">TwaQualityEnforcementViolationType(enum.Enum):</span>
    <span class="s1">K_HTTP_ERROR = </span><span class="s4">&quot;kHttpError&quot;</span>
    <span class="s1">K_UNAVAILABLE_OFFLINE = </span><span class="s4">&quot;kUnavailableOffline&quot;</span>
    <span class="s1">K_DIGITAL_ASSET_LINKS = </span><span class="s4">&quot;kDigitalAssetLinks&quot;</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s2">return </span><span class="s1">self.value</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(json)</span>


<span class="s1">@dataclass</span>
<span class="s2">class </span><span class="s1">TrustedWebActivityIssueDetails:</span>
    <span class="s0">#: The url that triggers the violation.</span>
    <span class="s1">url: str</span>

    <span class="s1">violation_type: TwaQualityEnforcementViolationType</span>

    <span class="s1">http_status_code: typing.Optional[int] = </span><span class="s2">None</span>

    <span class="s0">#: The package name of the Trusted Web Activity client app. This field is</span>
    <span class="s0">#: only used when violation type is kDigitalAssetLinks.</span>
    <span class="s1">package_name: typing.Optional[str] = </span><span class="s2">None</span>

    <span class="s0">#: The signature of the Trusted Web Activity client app. This field is only</span>
    <span class="s0">#: used when violation type is kDigitalAssetLinks.</span>
    <span class="s1">signature: typing.Optional[str] = </span><span class="s2">None</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s1">json = dict()</span>
        <span class="s1">json[</span><span class="s4">'url'</span><span class="s1">] = self.url</span>
        <span class="s1">json[</span><span class="s4">'violationType'</span><span class="s1">] = self.violation_type.to_json()</span>
        <span class="s2">if </span><span class="s1">self.http_status_code </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'httpStatusCode'</span><span class="s1">] = self.http_status_code</span>
        <span class="s2">if </span><span class="s1">self.package_name </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'packageName'</span><span class="s1">] = self.package_name</span>
        <span class="s2">if </span><span class="s1">self.signature </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'signature'</span><span class="s1">] = self.signature</span>
        <span class="s2">return </span><span class="s1">json</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(</span>
            <span class="s1">url=str(json[</span><span class="s4">'url'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">violation_type=TwaQualityEnforcementViolationType.from_json(json[</span><span class="s4">'violationType'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">http_status_code=int(json[</span><span class="s4">'httpStatusCode'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'httpStatusCode' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
            <span class="s1">package_name=str(json[</span><span class="s4">'packageName'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'packageName' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
            <span class="s1">signature=str(json[</span><span class="s4">'signature'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'signature' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
        <span class="s1">)</span>


<span class="s1">@dataclass</span>
<span class="s2">class </span><span class="s1">LowTextContrastIssueDetails:</span>
    <span class="s1">violating_node_id: dom.BackendNodeId</span>

    <span class="s1">violating_node_selector: str</span>

    <span class="s1">contrast_ratio: float</span>

    <span class="s1">threshold_aa: float</span>

    <span class="s1">threshold_aaa: float</span>

    <span class="s1">font_size: str</span>

    <span class="s1">font_weight: str</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s1">json = dict()</span>
        <span class="s1">json[</span><span class="s4">'violatingNodeId'</span><span class="s1">] = self.violating_node_id.to_json()</span>
        <span class="s1">json[</span><span class="s4">'violatingNodeSelector'</span><span class="s1">] = self.violating_node_selector</span>
        <span class="s1">json[</span><span class="s4">'contrastRatio'</span><span class="s1">] = self.contrast_ratio</span>
        <span class="s1">json[</span><span class="s4">'thresholdAA'</span><span class="s1">] = self.threshold_aa</span>
        <span class="s1">json[</span><span class="s4">'thresholdAAA'</span><span class="s1">] = self.threshold_aaa</span>
        <span class="s1">json[</span><span class="s4">'fontSize'</span><span class="s1">] = self.font_size</span>
        <span class="s1">json[</span><span class="s4">'fontWeight'</span><span class="s1">] = self.font_weight</span>
        <span class="s2">return </span><span class="s1">json</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(</span>
            <span class="s1">violating_node_id=dom.BackendNodeId.from_json(json[</span><span class="s4">'violatingNodeId'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">violating_node_selector=str(json[</span><span class="s4">'violatingNodeSelector'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">contrast_ratio=float(json[</span><span class="s4">'contrastRatio'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">threshold_aa=float(json[</span><span class="s4">'thresholdAA'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">threshold_aaa=float(json[</span><span class="s4">'thresholdAAA'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">font_size=str(json[</span><span class="s4">'fontSize'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">font_weight=str(json[</span><span class="s4">'fontWeight'</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>


<span class="s1">@dataclass</span>
<span class="s2">class </span><span class="s1">CorsIssueDetails:</span>
    <span class="s3">''' 
    Details for a CORS related issue, e.g. a warning or error related to 
    CORS RFC1918 enforcement. 
    '''</span>
    <span class="s1">cors_error_status: network.CorsErrorStatus</span>

    <span class="s1">is_warning: bool</span>

    <span class="s1">request: AffectedRequest</span>

    <span class="s1">initiator_origin: typing.Optional[str] = </span><span class="s2">None</span>

    <span class="s1">resource_ip_address_space: typing.Optional[network.IPAddressSpace] = </span><span class="s2">None</span>

    <span class="s1">client_security_state: typing.Optional[network.ClientSecurityState] = </span><span class="s2">None</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s1">json = dict()</span>
        <span class="s1">json[</span><span class="s4">'corsErrorStatus'</span><span class="s1">] = self.cors_error_status.to_json()</span>
        <span class="s1">json[</span><span class="s4">'isWarning'</span><span class="s1">] = self.is_warning</span>
        <span class="s1">json[</span><span class="s4">'request'</span><span class="s1">] = self.request.to_json()</span>
        <span class="s2">if </span><span class="s1">self.initiator_origin </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'initiatorOrigin'</span><span class="s1">] = self.initiator_origin</span>
        <span class="s2">if </span><span class="s1">self.resource_ip_address_space </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'resourceIPAddressSpace'</span><span class="s1">] = self.resource_ip_address_space.to_json()</span>
        <span class="s2">if </span><span class="s1">self.client_security_state </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'clientSecurityState'</span><span class="s1">] = self.client_security_state.to_json()</span>
        <span class="s2">return </span><span class="s1">json</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(</span>
            <span class="s1">cors_error_status=network.CorsErrorStatus.from_json(json[</span><span class="s4">'corsErrorStatus'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">is_warning=bool(json[</span><span class="s4">'isWarning'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">request=AffectedRequest.from_json(json[</span><span class="s4">'request'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">initiator_origin=str(json[</span><span class="s4">'initiatorOrigin'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'initiatorOrigin' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
            <span class="s1">resource_ip_address_space=network.IPAddressSpace.from_json(json[</span><span class="s4">'resourceIPAddressSpace'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'resourceIPAddressSpace' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
            <span class="s1">client_security_state=network.ClientSecurityState.from_json(json[</span><span class="s4">'clientSecurityState'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'clientSecurityState' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
        <span class="s1">)</span>


<span class="s2">class </span><span class="s1">InspectorIssueCode(enum.Enum):</span>
    <span class="s3">''' 
    A unique identifier for the type of issue. Each type may use one of the 
    optional fields in InspectorIssueDetails to convey more specific 
    information about the kind of issue. 
    '''</span>
    <span class="s1">SAME_SITE_COOKIE_ISSUE = </span><span class="s4">&quot;SameSiteCookieIssue&quot;</span>
    <span class="s1">MIXED_CONTENT_ISSUE = </span><span class="s4">&quot;MixedContentIssue&quot;</span>
    <span class="s1">BLOCKED_BY_RESPONSE_ISSUE = </span><span class="s4">&quot;BlockedByResponseIssue&quot;</span>
    <span class="s1">HEAVY_AD_ISSUE = </span><span class="s4">&quot;HeavyAdIssue&quot;</span>
    <span class="s1">CONTENT_SECURITY_POLICY_ISSUE = </span><span class="s4">&quot;ContentSecurityPolicyIssue&quot;</span>
    <span class="s1">SHARED_ARRAY_BUFFER_ISSUE = </span><span class="s4">&quot;SharedArrayBufferIssue&quot;</span>
    <span class="s1">TRUSTED_WEB_ACTIVITY_ISSUE = </span><span class="s4">&quot;TrustedWebActivityIssue&quot;</span>
    <span class="s1">LOW_TEXT_CONTRAST_ISSUE = </span><span class="s4">&quot;LowTextContrastIssue&quot;</span>
    <span class="s1">CORS_ISSUE = </span><span class="s4">&quot;CorsIssue&quot;</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s2">return </span><span class="s1">self.value</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(json)</span>


<span class="s1">@dataclass</span>
<span class="s2">class </span><span class="s1">InspectorIssueDetails:</span>
    <span class="s3">''' 
    This struct holds a list of optional fields with additional information 
    specific to the kind of issue. When adding a new issue code, please also 
    add a new optional field to this type. 
    '''</span>
    <span class="s1">same_site_cookie_issue_details: typing.Optional[SameSiteCookieIssueDetails] = </span><span class="s2">None</span>

    <span class="s1">mixed_content_issue_details: typing.Optional[MixedContentIssueDetails] = </span><span class="s2">None</span>

    <span class="s1">blocked_by_response_issue_details: typing.Optional[BlockedByResponseIssueDetails] = </span><span class="s2">None</span>

    <span class="s1">heavy_ad_issue_details: typing.Optional[HeavyAdIssueDetails] = </span><span class="s2">None</span>

    <span class="s1">content_security_policy_issue_details: typing.Optional[ContentSecurityPolicyIssueDetails] = </span><span class="s2">None</span>

    <span class="s1">shared_array_buffer_issue_details: typing.Optional[SharedArrayBufferIssueDetails] = </span><span class="s2">None</span>

    <span class="s1">twa_quality_enforcement_details: typing.Optional[TrustedWebActivityIssueDetails] = </span><span class="s2">None</span>

    <span class="s1">low_text_contrast_issue_details: typing.Optional[LowTextContrastIssueDetails] = </span><span class="s2">None</span>

    <span class="s1">cors_issue_details: typing.Optional[CorsIssueDetails] = </span><span class="s2">None</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s1">json = dict()</span>
        <span class="s2">if </span><span class="s1">self.same_site_cookie_issue_details </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'sameSiteCookieIssueDetails'</span><span class="s1">] = self.same_site_cookie_issue_details.to_json()</span>
        <span class="s2">if </span><span class="s1">self.mixed_content_issue_details </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'mixedContentIssueDetails'</span><span class="s1">] = self.mixed_content_issue_details.to_json()</span>
        <span class="s2">if </span><span class="s1">self.blocked_by_response_issue_details </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'blockedByResponseIssueDetails'</span><span class="s1">] = self.blocked_by_response_issue_details.to_json()</span>
        <span class="s2">if </span><span class="s1">self.heavy_ad_issue_details </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'heavyAdIssueDetails'</span><span class="s1">] = self.heavy_ad_issue_details.to_json()</span>
        <span class="s2">if </span><span class="s1">self.content_security_policy_issue_details </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'contentSecurityPolicyIssueDetails'</span><span class="s1">] = self.content_security_policy_issue_details.to_json()</span>
        <span class="s2">if </span><span class="s1">self.shared_array_buffer_issue_details </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'sharedArrayBufferIssueDetails'</span><span class="s1">] = self.shared_array_buffer_issue_details.to_json()</span>
        <span class="s2">if </span><span class="s1">self.twa_quality_enforcement_details </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'twaQualityEnforcementDetails'</span><span class="s1">] = self.twa_quality_enforcement_details.to_json()</span>
        <span class="s2">if </span><span class="s1">self.low_text_contrast_issue_details </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'lowTextContrastIssueDetails'</span><span class="s1">] = self.low_text_contrast_issue_details.to_json()</span>
        <span class="s2">if </span><span class="s1">self.cors_issue_details </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">json[</span><span class="s4">'corsIssueDetails'</span><span class="s1">] = self.cors_issue_details.to_json()</span>
        <span class="s2">return </span><span class="s1">json</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(</span>
            <span class="s1">same_site_cookie_issue_details=SameSiteCookieIssueDetails.from_json(json[</span><span class="s4">'sameSiteCookieIssueDetails'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'sameSiteCookieIssueDetails' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
            <span class="s1">mixed_content_issue_details=MixedContentIssueDetails.from_json(json[</span><span class="s4">'mixedContentIssueDetails'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'mixedContentIssueDetails' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
            <span class="s1">blocked_by_response_issue_details=BlockedByResponseIssueDetails.from_json(json[</span><span class="s4">'blockedByResponseIssueDetails'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'blockedByResponseIssueDetails' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
            <span class="s1">heavy_ad_issue_details=HeavyAdIssueDetails.from_json(json[</span><span class="s4">'heavyAdIssueDetails'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'heavyAdIssueDetails' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
            <span class="s1">content_security_policy_issue_details=ContentSecurityPolicyIssueDetails.from_json(json[</span><span class="s4">'contentSecurityPolicyIssueDetails'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'contentSecurityPolicyIssueDetails' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
            <span class="s1">shared_array_buffer_issue_details=SharedArrayBufferIssueDetails.from_json(json[</span><span class="s4">'sharedArrayBufferIssueDetails'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'sharedArrayBufferIssueDetails' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
            <span class="s1">twa_quality_enforcement_details=TrustedWebActivityIssueDetails.from_json(json[</span><span class="s4">'twaQualityEnforcementDetails'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'twaQualityEnforcementDetails' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
            <span class="s1">low_text_contrast_issue_details=LowTextContrastIssueDetails.from_json(json[</span><span class="s4">'lowTextContrastIssueDetails'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'lowTextContrastIssueDetails' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
            <span class="s1">cors_issue_details=CorsIssueDetails.from_json(json[</span><span class="s4">'corsIssueDetails'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'corsIssueDetails' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
        <span class="s1">)</span>


<span class="s1">@dataclass</span>
<span class="s2">class </span><span class="s1">InspectorIssue:</span>
    <span class="s3">''' 
    An inspector issue reported from the back-end. 
    '''</span>
    <span class="s1">code: InspectorIssueCode</span>

    <span class="s1">details: InspectorIssueDetails</span>

    <span class="s2">def </span><span class="s1">to_json(self):</span>
        <span class="s1">json = dict()</span>
        <span class="s1">json[</span><span class="s4">'code'</span><span class="s1">] = self.code.to_json()</span>
        <span class="s1">json[</span><span class="s4">'details'</span><span class="s1">] = self.details.to_json()</span>
        <span class="s2">return </span><span class="s1">json</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json):</span>
        <span class="s2">return </span><span class="s1">cls(</span>
            <span class="s1">code=InspectorIssueCode.from_json(json[</span><span class="s4">'code'</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">details=InspectorIssueDetails.from_json(json[</span><span class="s4">'details'</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span>


<span class="s2">def </span><span class="s1">get_encoded_response(</span>
        <span class="s1">request_id: network.RequestId</span><span class="s2">,</span>
        <span class="s1">encoding: str</span><span class="s2">,</span>
        <span class="s1">quality: typing.Optional[float] = </span><span class="s2">None,</span>
        <span class="s1">size_only: typing.Optional[bool] = </span><span class="s2">None</span>
    <span class="s1">) -&gt; typing.Generator[T_JSON_DICT</span><span class="s2">,</span><span class="s1">T_JSON_DICT</span><span class="s2">,</span><span class="s1">typing.Tuple[typing.Optional[str]</span><span class="s2">, </span><span class="s1">int</span><span class="s2">, </span><span class="s1">int]]:</span>
    <span class="s3">''' 
    Returns the response body and size if it were re-encoded with the specified settings. Only 
    applies to images. 
 
    :param request_id: Identifier of the network request to get content for. 
    :param encoding: The encoding to use. 
    :param quality: *(Optional)* The quality of the encoding (0-1). (defaults to 1) 
    :param size_only: *(Optional)* Whether to only return the size information (defaults to false). 
    :returns: A tuple with the following items: 
 
        0. **body** - *(Optional)* The encoded body as a base64 string. Omitted if sizeOnly is true. 
        1. **originalSize** - Size before re-encoding. 
        2. **encodedSize** - Size after re-encoding. 
    '''</span>
    <span class="s1">params: T_JSON_DICT = dict()</span>
    <span class="s1">params[</span><span class="s4">'requestId'</span><span class="s1">] = request_id.to_json()</span>
    <span class="s1">params[</span><span class="s4">'encoding'</span><span class="s1">] = encoding</span>
    <span class="s2">if </span><span class="s1">quality </span><span class="s2">is not None</span><span class="s1">:</span>
        <span class="s1">params[</span><span class="s4">'quality'</span><span class="s1">] = quality</span>
    <span class="s2">if </span><span class="s1">size_only </span><span class="s2">is not None</span><span class="s1">:</span>
        <span class="s1">params[</span><span class="s4">'sizeOnly'</span><span class="s1">] = size_only</span>
    <span class="s1">cmd_dict: T_JSON_DICT = {</span>
        <span class="s4">'method'</span><span class="s1">: </span><span class="s4">'Audits.getEncodedResponse'</span><span class="s2">,</span>
        <span class="s4">'params'</span><span class="s1">: params</span><span class="s2">,</span>
    <span class="s1">}</span>
    <span class="s1">json = </span><span class="s2">yield </span><span class="s1">cmd_dict</span>
    <span class="s2">return </span><span class="s1">(</span>
        <span class="s1">str(json[</span><span class="s4">'body'</span><span class="s1">]) </span><span class="s2">if </span><span class="s4">'body' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None,</span>
        <span class="s1">int(json[</span><span class="s4">'originalSize'</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">int(json[</span><span class="s4">'encodedSize'</span><span class="s1">])</span>
    <span class="s1">)</span>


<span class="s2">def </span><span class="s1">disable() -&gt; typing.Generator[T_JSON_DICT</span><span class="s2">,</span><span class="s1">T_JSON_DICT</span><span class="s2">,None</span><span class="s1">]:</span>
    <span class="s3">''' 
    Disables issues domain, prevents further issues from being reported to the client. 
    '''</span>
    <span class="s1">cmd_dict: T_JSON_DICT = {</span>
        <span class="s4">'method'</span><span class="s1">: </span><span class="s4">'Audits.disable'</span><span class="s2">,</span>
    <span class="s1">}</span>
    <span class="s1">json = </span><span class="s2">yield </span><span class="s1">cmd_dict</span>


<span class="s2">def </span><span class="s1">enable() -&gt; typing.Generator[T_JSON_DICT</span><span class="s2">,</span><span class="s1">T_JSON_DICT</span><span class="s2">,None</span><span class="s1">]:</span>
    <span class="s3">''' 
    Enables issues domain, sends the issues collected so far to the client by means of the 
    ``issueAdded`` event. 
    '''</span>
    <span class="s1">cmd_dict: T_JSON_DICT = {</span>
        <span class="s4">'method'</span><span class="s1">: </span><span class="s4">'Audits.enable'</span><span class="s2">,</span>
    <span class="s1">}</span>
    <span class="s1">json = </span><span class="s2">yield </span><span class="s1">cmd_dict</span>


<span class="s2">def </span><span class="s1">check_contrast(</span>
        <span class="s1">report_aaa: typing.Optional[bool] = </span><span class="s2">None</span>
    <span class="s1">) -&gt; typing.Generator[T_JSON_DICT</span><span class="s2">,</span><span class="s1">T_JSON_DICT</span><span class="s2">,None</span><span class="s1">]:</span>
    <span class="s3">''' 
    Runs the contrast check for the target page. Found issues are reported 
    using Audits.issueAdded event. 
 
    :param report_aaa: *(Optional)* Whether to report WCAG AAA level issues. Default is false. 
    '''</span>
    <span class="s1">params: T_JSON_DICT = dict()</span>
    <span class="s2">if </span><span class="s1">report_aaa </span><span class="s2">is not None</span><span class="s1">:</span>
        <span class="s1">params[</span><span class="s4">'reportAAA'</span><span class="s1">] = report_aaa</span>
    <span class="s1">cmd_dict: T_JSON_DICT = {</span>
        <span class="s4">'method'</span><span class="s1">: </span><span class="s4">'Audits.checkContrast'</span><span class="s2">,</span>
        <span class="s4">'params'</span><span class="s1">: params</span><span class="s2">,</span>
    <span class="s1">}</span>
    <span class="s1">json = </span><span class="s2">yield </span><span class="s1">cmd_dict</span>


<span class="s1">@event_class(</span><span class="s4">'Audits.issueAdded'</span><span class="s1">)</span>
<span class="s1">@dataclass</span>
<span class="s2">class </span><span class="s1">IssueAdded:</span>
    <span class="s1">issue: InspectorIssue</span>

    <span class="s1">@classmethod</span>
    <span class="s2">def </span><span class="s1">from_json(cls</span><span class="s2">, </span><span class="s1">json: T_JSON_DICT) -&gt; IssueAdded:</span>
        <span class="s2">return </span><span class="s1">cls(</span>
            <span class="s1">issue=InspectorIssue.from_json(json[</span><span class="s4">'issue'</span><span class="s1">])</span>
        <span class="s1">)</span>
</pre>
</body>
</html>