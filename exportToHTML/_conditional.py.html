<html>
<head>
<title>_conditional.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #808080;}
.s1 { color: #a9b7c6;}
.s2 { color: #cc7832;}
.s3 { color: #6a8759;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
_conditional.py</font>
</center></td></tr></table>
<pre><span class="s0"># This file is dual licensed under the terms of the Apache License, Version</span>
<span class="s0"># 2.0, and the BSD License. See the LICENSE file in the root of this repository</span>
<span class="s0"># for complete details.</span>


<span class="s2">def </span><span class="s1">cryptography_has_ec2m():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;EC_POINT_set_affine_coordinates_GF2m&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;EC_POINT_get_affine_coordinates_GF2m&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;EC_POINT_set_compressed_coordinates_GF2m&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_rsa_oaep_md():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;EVP_PKEY_CTX_set_rsa_oaep_md&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_rsa_oaep_label():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;EVP_PKEY_CTX_set0_rsa_oaep_label&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_ssl3_method():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;SSLv3_method&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSLv3_client_method&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSLv3_server_method&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_102_verification():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;X509_V_ERR_SUITE_B_INVALID_VERSION&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;X509_V_ERR_SUITE_B_INVALID_ALGORITHM&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;X509_V_ERR_SUITE_B_INVALID_CURVE&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;X509_V_ERR_SUITE_B_INVALID_SIGNATURE_ALGORITHM&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;X509_V_ERR_SUITE_B_LOS_NOT_ALLOWED&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;X509_V_ERR_SUITE_B_CANNOT_SIGN_P_384_WITH_P_256&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;X509_V_FLAG_SUITEB_128_LOS_ONLY&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;X509_V_FLAG_SUITEB_192_LOS&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;X509_V_FLAG_SUITEB_128_LOS&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_110_verification_params():</span>
    <span class="s2">return </span><span class="s1">[</span><span class="s3">&quot;X509_CHECK_FLAG_NEVER_CHECK_SUBJECT&quot;</span><span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_set_cert_cb():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;SSL_CTX_set_cert_cb&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSL_set_cert_cb&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_ssl_st():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;SSL_ST_BEFORE&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSL_ST_OK&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSL_ST_INIT&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSL_ST_RENEGOTIATE&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_tls_st():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;TLS_ST_BEFORE&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;TLS_ST_OK&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_scrypt():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;EVP_PBE_scrypt&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_evp_pkey_dhx():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;EVP_PKEY_DHX&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_mem_functions():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;Cryptography_CRYPTO_set_mem_functions&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_sct():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;SCT_get_version&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SCT_get_log_entry_type&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SCT_get0_log_id&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SCT_get0_signature&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SCT_get_timestamp&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SCT_set_source&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;sk_SCT_new_null&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;sk_SCT_free&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;sk_SCT_num&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;sk_SCT_value&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;sk_SCT_push&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SCT_LIST_free&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SCT_new&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SCT_set1_log_id&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SCT_set_timestamp&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SCT_set_version&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SCT_set_log_entry_type&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_x509_store_ctx_get_issuer():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;X509_STORE_get_get_issuer&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;X509_STORE_set_get_issuer&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_ed448():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;EVP_PKEY_ED448&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;NID_ED448&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_ed25519():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;NID_ED25519&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;EVP_PKEY_ED25519&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_poly1305():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;NID_poly1305&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;EVP_PKEY_POLY1305&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_oneshot_evp_digest_sign_verify():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;EVP_DigestSign&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;EVP_DigestVerify&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_evp_digestfinal_xof():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;EVP_DigestFinalXOF&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_evp_pkey_get_set_tls_encodedpoint():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;EVP_PKEY_get1_tls_encodedpoint&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;EVP_PKEY_set1_tls_encodedpoint&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_fips():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;FIPS_mode_set&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;FIPS_mode&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_ssl_sigalgs():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;SSL_CTX_set1_sigalgs_list&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSL_get_sigalgs&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_psk():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;SSL_CTX_use_psk_identity_hint&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSL_CTX_set_psk_server_callback&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSL_CTX_set_psk_client_callback&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_custom_ext():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;SSL_CTX_add_client_custom_ext&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSL_CTX_add_server_custom_ext&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSL_extension_supported&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_openssl_cleanup():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;OPENSSL_cleanup&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_tlsv13():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;TLS1_3_VERSION&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSL_OP_NO_TLSv1_3&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSL_VERIFY_POST_HANDSHAKE&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSL_CTX_set_ciphersuites&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSL_verify_client_post_handshake&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSL_CTX_set_post_handshake_auth&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSL_set_post_handshake_auth&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSL_SESSION_get_max_early_data&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSL_write_early_data&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSL_read_early_data&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSL_CTX_set_max_early_data&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_keylog():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;SSL_CTX_set_keylog_callback&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSL_CTX_get_keylog_callback&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_raw_key():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;EVP_PKEY_new_raw_private_key&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;EVP_PKEY_new_raw_public_key&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;EVP_PKEY_get_raw_private_key&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;EVP_PKEY_get_raw_public_key&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_engine():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;ENGINE_by_id&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;ENGINE_init&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;ENGINE_finish&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;ENGINE_get_default_RAND&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;ENGINE_set_default_RAND&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;ENGINE_unregister_RAND&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;ENGINE_ctrl_cmd&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;ENGINE_free&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;ENGINE_get_name&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;Cryptography_add_osrandom_engine&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;ENGINE_ctrl_cmd_string&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;ENGINE_load_builtin_engines&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;ENGINE_load_private_key&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;ENGINE_load_public_key&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_verified_chain():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;SSL_get0_verified_chain&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_srtp():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;SSL_CTX_set_tlsext_use_srtp&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSL_set_tlsext_use_srtp&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSL_get_selected_srtp_profile&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s2">def </span><span class="s1">cryptography_has_get_proto_version():</span>
    <span class="s2">return </span><span class="s1">[</span>
        <span class="s3">&quot;SSL_CTX_get_min_proto_version&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSL_CTX_get_max_proto_version&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSL_get_min_proto_version&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;SSL_get_max_proto_version&quot;</span><span class="s2">,</span>
    <span class="s1">]</span>


<span class="s0"># This is a mapping of</span>
<span class="s0"># {condition: function-returning-names-dependent-on-that-condition} so we can</span>
<span class="s0"># loop over them and delete unsupported names at runtime. It will be removed</span>
<span class="s0"># when cffi supports #if in cdef. We use functions instead of just a dict of</span>
<span class="s0"># lists so we can use coverage to measure which are used.</span>
<span class="s1">CONDITIONAL_NAMES = {</span>
    <span class="s3">&quot;Cryptography_HAS_EC2M&quot;</span><span class="s1">: cryptography_has_ec2m</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_RSA_OAEP_MD&quot;</span><span class="s1">: cryptography_has_rsa_oaep_md</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_RSA_OAEP_LABEL&quot;</span><span class="s1">: cryptography_has_rsa_oaep_label</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_SSL3_METHOD&quot;</span><span class="s1">: cryptography_has_ssl3_method</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_102_VERIFICATION&quot;</span><span class="s1">: cryptography_has_102_verification</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_110_VERIFICATION_PARAMS&quot;</span><span class="s1">: (</span>
        <span class="s1">cryptography_has_110_verification_params</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_SET_CERT_CB&quot;</span><span class="s1">: cryptography_has_set_cert_cb</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_SSL_ST&quot;</span><span class="s1">: cryptography_has_ssl_st</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_TLS_ST&quot;</span><span class="s1">: cryptography_has_tls_st</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_SCRYPT&quot;</span><span class="s1">: cryptography_has_scrypt</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_EVP_PKEY_DHX&quot;</span><span class="s1">: cryptography_has_evp_pkey_dhx</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_MEM_FUNCTIONS&quot;</span><span class="s1">: cryptography_has_mem_functions</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_SCT&quot;</span><span class="s1">: cryptography_has_sct</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_X509_STORE_CTX_GET_ISSUER&quot;</span><span class="s1">: (</span>
        <span class="s1">cryptography_has_x509_store_ctx_get_issuer</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_ED448&quot;</span><span class="s1">: cryptography_has_ed448</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_ED25519&quot;</span><span class="s1">: cryptography_has_ed25519</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_POLY1305&quot;</span><span class="s1">: cryptography_has_poly1305</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_ONESHOT_EVP_DIGEST_SIGN_VERIFY&quot;</span><span class="s1">: (</span>
        <span class="s1">cryptography_has_oneshot_evp_digest_sign_verify</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_EVP_PKEY_get_set_tls_encodedpoint&quot;</span><span class="s1">: (</span>
        <span class="s1">cryptography_has_evp_pkey_get_set_tls_encodedpoint</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_FIPS&quot;</span><span class="s1">: cryptography_has_fips</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_SIGALGS&quot;</span><span class="s1">: cryptography_has_ssl_sigalgs</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_PSK&quot;</span><span class="s1">: cryptography_has_psk</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_CUSTOM_EXT&quot;</span><span class="s1">: cryptography_has_custom_ext</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_OPENSSL_CLEANUP&quot;</span><span class="s1">: cryptography_has_openssl_cleanup</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_TLSv1_3&quot;</span><span class="s1">: cryptography_has_tlsv13</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_KEYLOG&quot;</span><span class="s1">: cryptography_has_keylog</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_RAW_KEY&quot;</span><span class="s1">: cryptography_has_raw_key</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_EVP_DIGESTFINAL_XOF&quot;</span><span class="s1">: (</span>
        <span class="s1">cryptography_has_evp_digestfinal_xof</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_ENGINE&quot;</span><span class="s1">: cryptography_has_engine</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_VERIFIED_CHAIN&quot;</span><span class="s1">: cryptography_has_verified_chain</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_SRTP&quot;</span><span class="s1">: cryptography_has_srtp</span><span class="s2">,</span>
    <span class="s3">&quot;Cryptography_HAS_GET_PROTO_VERSION&quot;</span><span class="s1">: cryptography_has_get_proto_version</span><span class="s2">,</span>
<span class="s1">}</span>
</pre>
</body>
</html>